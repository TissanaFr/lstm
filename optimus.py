from selenium import webdriver
import xlsxwriter

from selenium.webdriver.support.ui import WebDriverWait
from selenium.webdriver.support import expected_conditions as EC
from selenium.webdriver.common.by import By
from selenium.common.exceptions import TimeoutException

import click


@click.command()
@click.option('--ex_path', help='Path for your browser driver.')
@click.option('--user', help='Login to 0ptimus.')
@click.option('--pwd', help='Password to 0ptimus.')
def retrieve(ex_path, user, pwd):
    user = 'alisalisalis123@gmail.com'
    pwd = 'qwerty123!'

    if not user:
        print('Enter your login!')
        return

    if not pwd:
        print('Enter your password!')
        return

    delay = 5
    if ex_path:
        driver = webdriver.Chrome(executable_path=ex_path)
    else:
        driver = webdriver.Chrome()

    links = {'https://0ptimus.decisiondeskhq.com/house/AL-HOUSE-01': ('AL', '01'),
             'https://0ptimus.decisiondeskhq.com/house/AL-HOUSE-02': ('AL', '02'),
             'https://0ptimus.decisiondeskhq.com/house/AL-HOUSE-03': ('AL', '03'),
             'https://0ptimus.decisiondeskhq.com/house/AL-HOUSE-04': ('AL', '04'),
             'https://0ptimus.decisiondeskhq.com/house/AL-HOUSE-05': ('AL', '05'),
             'https://0ptimus.decisiondeskhq.com/house/AL-HOUSE-06': ('AL', '06'), 'https://0ptimus.decisiondeskhq.com/house/AL-HOUSE-07': ('AL', '07'), 'https://0ptimus.decisiondeskhq.com/house/AK-HOUSE-At-Large': ('AK', '01'), 'https://0ptimus.decisiondeskhq.com/house/AZ-HOUSE-01': ('AZ', '01'), 'https://0ptimus.decisiondeskhq.com/house/AZ-HOUSE-02': ('AZ', '02'), 'https://0ptimus.decisiondeskhq.com/house/AZ-HOUSE-03': ('AZ', '03'), 'https://0ptimus.decisiondeskhq.com/house/AZ-HOUSE-04': ('AZ', '04'), 'https://0ptimus.decisiondeskhq.com/house/AZ-HOUSE-05': ('AZ', '05'), 'https://0ptimus.decisiondeskhq.com/house/AZ-HOUSE-06': ('AZ', '06'), 'https://0ptimus.decisiondeskhq.com/house/AZ-HOUSE-07': ('AZ', '07'), 'https://0ptimus.decisiondeskhq.com/house/AZ-HOUSE-08': ('AZ', '08'), 'https://0ptimus.decisiondeskhq.com/house/AZ-HOUSE-09': ('AZ', '09'), 'https://0ptimus.decisiondeskhq.com/house/AR-HOUSE-01': ('AR', '01'), 'https://0ptimus.decisiondeskhq.com/house/AR-HOUSE-02': ('AR', '02'), 'https://0ptimus.decisiondeskhq.com/house/AR-HOUSE-03': ('AR', '03'), 'https://0ptimus.decisiondeskhq.com/house/AR-HOUSE-04': ('AR', '04'), 'https://0ptimus.decisiondeskhq.com/house/CA-HOUSE-01': ('CA', '01'), 'https://0ptimus.decisiondeskhq.com/house/CA-HOUSE-02': ('CA', '02'), 'https://0ptimus.decisiondeskhq.com/house/CA-HOUSE-03': ('CA', '03'), 'https://0ptimus.decisiondeskhq.com/house/CA-HOUSE-04': ('CA', '04'), 'https://0ptimus.decisiondeskhq.com/house/CA-HOUSE-05': ('CA', '05'), 'https://0ptimus.decisiondeskhq.com/house/CA-HOUSE-06': ('CA', '06'), 'https://0ptimus.decisiondeskhq.com/house/CA-HOUSE-07': ('CA', '07'), 'https://0ptimus.decisiondeskhq.com/house/CA-HOUSE-08': ('CA', '08'), 'https://0ptimus.decisiondeskhq.com/house/CA-HOUSE-09': ('CA', '09'), 'https://0ptimus.decisiondeskhq.com/house/CA-HOUSE-10': ('CA', '10'), 'https://0ptimus.decisiondeskhq.com/house/CA-HOUSE-11': ('CA', '11'), 'https://0ptimus.decisiondeskhq.com/house/CA-HOUSE-12': ('CA', '12'), 'https://0ptimus.decisiondeskhq.com/house/CA-HOUSE-13': ('CA', '13'), 'https://0ptimus.decisiondeskhq.com/house/CA-HOUSE-14': ('CA', '14'), 'https://0ptimus.decisiondeskhq.com/house/CA-HOUSE-15': ('CA', '15'), 'https://0ptimus.decisiondeskhq.com/house/CA-HOUSE-16': ('CA', '16'), 'https://0ptimus.decisiondeskhq.com/house/CA-HOUSE-17': ('CA', '17'), 'https://0ptimus.decisiondeskhq.com/house/CA-HOUSE-18': ('CA', '18'), 'https://0ptimus.decisiondeskhq.com/house/CA-HOUSE-19': ('CA', '19'), 'https://0ptimus.decisiondeskhq.com/house/CA-HOUSE-20': ('CA', '20'), 'https://0ptimus.decisiondeskhq.com/house/CA-HOUSE-21': ('CA', '21'), 'https://0ptimus.decisiondeskhq.com/house/CA-HOUSE-22': ('CA', '22'), 'https://0ptimus.decisiondeskhq.com/house/CA-HOUSE-23': ('CA', '23'), 'https://0ptimus.decisiondeskhq.com/house/CA-HOUSE-24': ('CA', '24'), 'https://0ptimus.decisiondeskhq.com/house/CA-HOUSE-25': ('CA', '25'), 'https://0ptimus.decisiondeskhq.com/house/CA-HOUSE-26': ('CA', '26'), 'https://0ptimus.decisiondeskhq.com/house/CA-HOUSE-27': ('CA', '27'), 'https://0ptimus.decisiondeskhq.com/house/CA-HOUSE-28': ('CA', '28'), 'https://0ptimus.decisiondeskhq.com/house/CA-HOUSE-29': ('CA', '29'), 'https://0ptimus.decisiondeskhq.com/house/CA-HOUSE-30': ('CA', '30'), 'https://0ptimus.decisiondeskhq.com/house/CA-HOUSE-31': ('CA', '31'), 'https://0ptimus.decisiondeskhq.com/house/CA-HOUSE-32': ('CA', '32'), 'https://0ptimus.decisiondeskhq.com/house/CA-HOUSE-33': ('CA', '33'), 'https://0ptimus.decisiondeskhq.com/house/CA-HOUSE-34': ('CA', '34'), 'https://0ptimus.decisiondeskhq.com/house/CA-HOUSE-35': ('CA', '35'), 'https://0ptimus.decisiondeskhq.com/house/CA-HOUSE-36': ('CA', '36'), 'https://0ptimus.decisiondeskhq.com/house/CA-HOUSE-37': ('CA', '37'), 'https://0ptimus.decisiondeskhq.com/house/CA-HOUSE-38': ('CA', '38'), 'https://0ptimus.decisiondeskhq.com/house/CA-HOUSE-39': ('CA', '39'), 'https://0ptimus.decisiondeskhq.com/house/CA-HOUSE-40': ('CA', '40'), 'https://0ptimus.decisiondeskhq.com/house/CA-HOUSE-41': ('CA', '41'), 'https://0ptimus.decisiondeskhq.com/house/CA-HOUSE-42': ('CA', '42'), 'https://0ptimus.decisiondeskhq.com/house/CA-HOUSE-43': ('CA', '43'), 'https://0ptimus.decisiondeskhq.com/house/CA-HOUSE-44': ('CA', '44'), 'https://0ptimus.decisiondeskhq.com/house/CA-HOUSE-45': ('CA', '45'), 'https://0ptimus.decisiondeskhq.com/house/CA-HOUSE-46': ('CA', '46'), 'https://0ptimus.decisiondeskhq.com/house/CA-HOUSE-47': ('CA', '47'), 'https://0ptimus.decisiondeskhq.com/house/CA-HOUSE-48': ('CA', '48'), 'https://0ptimus.decisiondeskhq.com/house/CA-HOUSE-49': ('CA', '49'), 'https://0ptimus.decisiondeskhq.com/house/CA-HOUSE-50': ('CA', '50'), 'https://0ptimus.decisiondeskhq.com/house/CA-HOUSE-51': ('CA', '51'), 'https://0ptimus.decisiondeskhq.com/house/CA-HOUSE-52': ('CA', '52'), 'https://0ptimus.decisiondeskhq.com/house/CA-HOUSE-53': ('CA', '53'), 'https://0ptimus.decisiondeskhq.com/house/CO-HOUSE-01': ('CO', '01'), 'https://0ptimus.decisiondeskhq.com/house/CO-HOUSE-02': ('CO', '02'), 'https://0ptimus.decisiondeskhq.com/house/CO-HOUSE-03': ('CO', '03'), 'https://0ptimus.decisiondeskhq.com/house/CO-HOUSE-04': ('CO', '04'), 'https://0ptimus.decisiondeskhq.com/house/CO-HOUSE-05': ('CO', '05'), 'https://0ptimus.decisiondeskhq.com/house/CO-HOUSE-06': ('CO', '06'), 'https://0ptimus.decisiondeskhq.com/house/CO-HOUSE-07': ('CO', '07'), 'https://0ptimus.decisiondeskhq.com/house/CT-HOUSE-01': ('CT', '01'), 'https://0ptimus.decisiondeskhq.com/house/CT-HOUSE-02': ('CT', '02'), 'https://0ptimus.decisiondeskhq.com/house/CT-HOUSE-03': ('CT', '03'), 'https://0ptimus.decisiondeskhq.com/house/CT-HOUSE-04': ('CT', '04'), 'https://0ptimus.decisiondeskhq.com/house/CT-HOUSE-05': ('CT', '05'), 'https://0ptimus.decisiondeskhq.com/house/DE-HOUSE-At-Large': ('DE', '01'), 'https://0ptimus.decisiondeskhq.com/house/FL-HOUSE-01': ('FL', '01'), 'https://0ptimus.decisiondeskhq.com/house/FL-HOUSE-02': ('FL', '02'), 'https://0ptimus.decisiondeskhq.com/house/FL-HOUSE-03': ('FL', '03'), 'https://0ptimus.decisiondeskhq.com/house/FL-HOUSE-04': ('FL', '04'), 'https://0ptimus.decisiondeskhq.com/house/FL-HOUSE-05': ('FL', '05'), 'https://0ptimus.decisiondeskhq.com/house/FL-HOUSE-06': ('FL', '06'), 'https://0ptimus.decisiondeskhq.com/house/FL-HOUSE-07': ('FL', '07'), 'https://0ptimus.decisiondeskhq.com/house/FL-HOUSE-08': ('FL', '08'), 'https://0ptimus.decisiondeskhq.com/house/FL-HOUSE-09': ('FL', '09'), 'https://0ptimus.decisiondeskhq.com/house/FL-HOUSE-10': ('FL', '10'), 'https://0ptimus.decisiondeskhq.com/house/FL-HOUSE-11': ('FL', '11'), 'https://0ptimus.decisiondeskhq.com/house/FL-HOUSE-12': ('FL', '12'), 'https://0ptimus.decisiondeskhq.com/house/FL-HOUSE-13': ('FL', '13'), 'https://0ptimus.decisiondeskhq.com/house/FL-HOUSE-14': ('FL', '14'), 'https://0ptimus.decisiondeskhq.com/house/FL-HOUSE-15': ('FL', '15'), 'https://0ptimus.decisiondeskhq.com/house/FL-HOUSE-16': ('FL', '16'), 'https://0ptimus.decisiondeskhq.com/house/FL-HOUSE-17': ('FL', '17'), 'https://0ptimus.decisiondeskhq.com/house/FL-HOUSE-18': ('FL', '18'), 'https://0ptimus.decisiondeskhq.com/house/FL-HOUSE-19': ('FL', '19'), 'https://0ptimus.decisiondeskhq.com/house/FL-HOUSE-20': ('FL', '20'), 'https://0ptimus.decisiondeskhq.com/house/FL-HOUSE-21': ('FL', '21'), 'https://0ptimus.decisiondeskhq.com/house/FL-HOUSE-22': ('FL', '22'), 'https://0ptimus.decisiondeskhq.com/house/FL-HOUSE-23': ('FL', '23'), 'https://0ptimus.decisiondeskhq.com/house/FL-HOUSE-24': ('FL', '24'), 'https://0ptimus.decisiondeskhq.com/house/FL-HOUSE-25': ('FL', '25'), 'https://0ptimus.decisiondeskhq.com/house/FL-HOUSE-26': ('FL', '26'), 'https://0ptimus.decisiondeskhq.com/house/FL-HOUSE-27': ('FL', '27'), 'https://0ptimus.decisiondeskhq.com/house/GA-HOUSE-01': ('GA', '01'), 'https://0ptimus.decisiondeskhq.com/house/GA-HOUSE-02': ('GA', '02'), 'https://0ptimus.decisiondeskhq.com/house/GA-HOUSE-03': ('GA', '03'), 'https://0ptimus.decisiondeskhq.com/house/GA-HOUSE-04': ('GA', '04'), 'https://0ptimus.decisiondeskhq.com/house/GA-HOUSE-05': ('GA', '05'), 'https://0ptimus.decisiondeskhq.com/house/GA-HOUSE-06': ('GA', '06'), 'https://0ptimus.decisiondeskhq.com/house/GA-HOUSE-07': ('GA', '07'), 'https://0ptimus.decisiondeskhq.com/house/GA-HOUSE-08': ('GA', '08'), 'https://0ptimus.decisiondeskhq.com/house/GA-HOUSE-09': ('GA', '09'), 'https://0ptimus.decisiondeskhq.com/house/GA-HOUSE-10': ('GA', '10'), 'https://0ptimus.decisiondeskhq.com/house/GA-HOUSE-11': ('GA', '11'), 'https://0ptimus.decisiondeskhq.com/house/GA-HOUSE-12': ('GA', '12'), 'https://0ptimus.decisiondeskhq.com/house/GA-HOUSE-13': ('GA', '13'), 'https://0ptimus.decisiondeskhq.com/house/GA-HOUSE-14': ('GA', '14'), 'https://0ptimus.decisiondeskhq.com/house/HI-HOUSE-01': ('HI', '01'), 'https://0ptimus.decisiondeskhq.com/house/HI-HOUSE-02': ('HI', '02'), 'https://0ptimus.decisiondeskhq.com/house/ID-HOUSE-01': ('ID', '01'), 'https://0ptimus.decisiondeskhq.com/house/ID-HOUSE-02': ('ID', '02'), 'https://0ptimus.decisiondeskhq.com/house/IL-HOUSE-01': ('IL', '01'), 'https://0ptimus.decisiondeskhq.com/house/IL-HOUSE-02': ('IL', '02'), 'https://0ptimus.decisiondeskhq.com/house/IL-HOUSE-03': ('IL', '03'), 'https://0ptimus.decisiondeskhq.com/house/IL-HOUSE-04': ('IL', '04'), 'https://0ptimus.decisiondeskhq.com/house/IL-HOUSE-05': ('IL', '05'), 'https://0ptimus.decisiondeskhq.com/house/IL-HOUSE-06': ('IL', '06'), 'https://0ptimus.decisiondeskhq.com/house/IL-HOUSE-07': ('IL', '07'), 'https://0ptimus.decisiondeskhq.com/house/IL-HOUSE-08': ('IL', '08'), 'https://0ptimus.decisiondeskhq.com/house/IL-HOUSE-09': ('IL', '09'), 'https://0ptimus.decisiondeskhq.com/house/IL-HOUSE-10': ('IL', '10'), 'https://0ptimus.decisiondeskhq.com/house/IL-HOUSE-11': ('IL', '11'), 'https://0ptimus.decisiondeskhq.com/house/IL-HOUSE-12': ('IL', '12'), 'https://0ptimus.decisiondeskhq.com/house/IL-HOUSE-13': ('IL', '13'), 'https://0ptimus.decisiondeskhq.com/house/IL-HOUSE-14': ('IL', '14'), 'https://0ptimus.decisiondeskhq.com/house/IL-HOUSE-15': ('IL', '15'), 'https://0ptimus.decisiondeskhq.com/house/IL-HOUSE-16': ('IL', '16'), 'https://0ptimus.decisiondeskhq.com/house/IL-HOUSE-17': ('IL', '17'), 'https://0ptimus.decisiondeskhq.com/house/IL-HOUSE-18': ('IL', '18'), 'https://0ptimus.decisiondeskhq.com/house/IN-HOUSE-01': ('IN', '01'), 'https://0ptimus.decisiondeskhq.com/house/IN-HOUSE-02': ('IN', '02'), 'https://0ptimus.decisiondeskhq.com/house/IN-HOUSE-03': ('IN', '03'), 'https://0ptimus.decisiondeskhq.com/house/IN-HOUSE-04': ('IN', '04'), 'https://0ptimus.decisiondeskhq.com/house/IN-HOUSE-05': ('IN', '05'), 'https://0ptimus.decisiondeskhq.com/house/IN-HOUSE-06': ('IN', '06'), 'https://0ptimus.decisiondeskhq.com/house/IN-HOUSE-07': ('IN', '07'), 'https://0ptimus.decisiondeskhq.com/house/IN-HOUSE-08': ('IN', '08'), 'https://0ptimus.decisiondeskhq.com/house/IN-HOUSE-09': ('IN', '09'), 'https://0ptimus.decisiondeskhq.com/house/IA-HOUSE-01': ('IA', '01'), 'https://0ptimus.decisiondeskhq.com/house/IA-HOUSE-02': ('IA', '02'), 'https://0ptimus.decisiondeskhq.com/house/IA-HOUSE-03': ('IA', '03'), 'https://0ptimus.decisiondeskhq.com/house/IA-HOUSE-04': ('IA', '04'), 'https://0ptimus.decisiondeskhq.com/house/KS-HOUSE-01': ('KS', '01'), 'https://0ptimus.decisiondeskhq.com/house/KS-HOUSE-02': ('KS', '02'), 'https://0ptimus.decisiondeskhq.com/house/KS-HOUSE-03': ('KS', '03'), 'https://0ptimus.decisiondeskhq.com/house/KS-HOUSE-04': ('KS', '04'), 'https://0ptimus.decisiondeskhq.com/house/KY-HOUSE-01': ('KY', '01'), 'https://0ptimus.decisiondeskhq.com/house/KY-HOUSE-02': ('KY', '02'), 'https://0ptimus.decisiondeskhq.com/house/KY-HOUSE-03': ('KY', '03'), 'https://0ptimus.decisiondeskhq.com/house/KY-HOUSE-04': ('KY', '04'), 'https://0ptimus.decisiondeskhq.com/house/KY-HOUSE-05': ('KY', '05'), 'https://0ptimus.decisiondeskhq.com/house/KY-HOUSE-06': ('KY', '06'), 'https://0ptimus.decisiondeskhq.com/house/LA-HOUSE-01': ('LA', '01'), 'https://0ptimus.decisiondeskhq.com/house/LA-HOUSE-02': ('LA', '02'), 'https://0ptimus.decisiondeskhq.com/house/LA-HOUSE-03': ('LA', '03'), 'https://0ptimus.decisiondeskhq.com/house/LA-HOUSE-04': ('LA', '04'), 'https://0ptimus.decisiondeskhq.com/house/LA-HOUSE-05': ('LA', '05'), 'https://0ptimus.decisiondeskhq.com/house/LA-HOUSE-06': ('LA', '06'), 'https://0ptimus.decisiondeskhq.com/house/ME-HOUSE-01': ('ME', '01'), 'https://0ptimus.decisiondeskhq.com/house/ME-HOUSE-02': ('ME', '02'), 'https://0ptimus.decisiondeskhq.com/house/MD-HOUSE-01': ('MD', '01'), 'https://0ptimus.decisiondeskhq.com/house/MD-HOUSE-02': ('MD', '02'), 'https://0ptimus.decisiondeskhq.com/house/MD-HOUSE-03': ('MD', '03'), 'https://0ptimus.decisiondeskhq.com/house/MD-HOUSE-04': ('MD', '04'), 'https://0ptimus.decisiondeskhq.com/house/MD-HOUSE-05': ('MD', '05'), 'https://0ptimus.decisiondeskhq.com/house/MD-HOUSE-06': ('MD', '06'), 'https://0ptimus.decisiondeskhq.com/house/MD-HOUSE-07': ('MD', '07'), 'https://0ptimus.decisiondeskhq.com/house/MD-HOUSE-08': ('MD', '08'), 'https://0ptimus.decisiondeskhq.com/house/MA-HOUSE-01': ('MA', '01'), 'https://0ptimus.decisiondeskhq.com/house/MA-HOUSE-02': ('MA', '02'), 'https://0ptimus.decisiondeskhq.com/house/MA-HOUSE-03': ('MA', '03'), 'https://0ptimus.decisiondeskhq.com/house/MA-HOUSE-04': ('MA', '04'), 'https://0ptimus.decisiondeskhq.com/house/MA-HOUSE-05': ('MA', '05'), 'https://0ptimus.decisiondeskhq.com/house/MA-HOUSE-06': ('MA', '06'), 'https://0ptimus.decisiondeskhq.com/house/MA-HOUSE-07': ('MA', '07'), 'https://0ptimus.decisiondeskhq.com/house/MA-HOUSE-08': ('MA', '08'), 'https://0ptimus.decisiondeskhq.com/house/MA-HOUSE-09': ('MA', '09'), 'https://0ptimus.decisiondeskhq.com/house/MI-HOUSE-01': ('MI', '01'), 'https://0ptimus.decisiondeskhq.com/house/MI-HOUSE-02': ('MI', '02'), 'https://0ptimus.decisiondeskhq.com/house/MI-HOUSE-03': ('MI', '03'), 'https://0ptimus.decisiondeskhq.com/house/MI-HOUSE-04': ('MI', '04'), 'https://0ptimus.decisiondeskhq.com/house/MI-HOUSE-05': ('MI', '05'), 'https://0ptimus.decisiondeskhq.com/house/MI-HOUSE-06': ('MI', '06'), 'https://0ptimus.decisiondeskhq.com/house/MI-HOUSE-07': ('MI', '07'), 'https://0ptimus.decisiondeskhq.com/house/MI-HOUSE-08': ('MI', '08'), 'https://0ptimus.decisiondeskhq.com/house/MI-HOUSE-09': ('MI', '09'), 'https://0ptimus.decisiondeskhq.com/house/MI-HOUSE-10': ('MI', '10'), 'https://0ptimus.decisiondeskhq.com/house/MI-HOUSE-11': ('MI', '11'), 'https://0ptimus.decisiondeskhq.com/house/MI-HOUSE-12': ('MI', '12'), 'https://0ptimus.decisiondeskhq.com/house/MI-HOUSE-13': ('MI', '13'), 'https://0ptimus.decisiondeskhq.com/house/MI-HOUSE-14': ('MI', '14'), 'https://0ptimus.decisiondeskhq.com/house/MN-HOUSE-01': ('MN', '01'), 'https://0ptimus.decisiondeskhq.com/house/MN-HOUSE-02': ('MN', '02'), 'https://0ptimus.decisiondeskhq.com/house/MN-HOUSE-03': ('MN', '03'), 'https://0ptimus.decisiondeskhq.com/house/MN-HOUSE-04': ('MN', '04'), 'https://0ptimus.decisiondeskhq.com/house/MN-HOUSE-05': ('MN', '05'), 'https://0ptimus.decisiondeskhq.com/house/MN-HOUSE-06': ('MN', '06'), 'https://0ptimus.decisiondeskhq.com/house/MN-HOUSE-07': ('MN', '07'), 'https://0ptimus.decisiondeskhq.com/house/MN-HOUSE-08': ('MN', '08'), 'https://0ptimus.decisiondeskhq.com/house/MS-HOUSE-01': ('MS', '01'), 'https://0ptimus.decisiondeskhq.com/house/MS-HOUSE-02': ('MS', '02'), 'https://0ptimus.decisiondeskhq.com/house/MS-HOUSE-03': ('MS', '03'), 'https://0ptimus.decisiondeskhq.com/house/MS-HOUSE-04': ('MS', '04'), 'https://0ptimus.decisiondeskhq.com/house/MO-HOUSE-01': ('MO', '01'), 'https://0ptimus.decisiondeskhq.com/house/MO-HOUSE-02': ('MO', '02'), 'https://0ptimus.decisiondeskhq.com/house/MO-HOUSE-03': ('MO', '03'), 'https://0ptimus.decisiondeskhq.com/house/MO-HOUSE-04': ('MO', '04'), 'https://0ptimus.decisiondeskhq.com/house/MO-HOUSE-05': ('MO', '05'), 'https://0ptimus.decisiondeskhq.com/house/MO-HOUSE-06': ('MO', '06'), 'https://0ptimus.decisiondeskhq.com/house/MO-HOUSE-07': ('MO', '07'), 'https://0ptimus.decisiondeskhq.com/house/MO-HOUSE-08': ('MO', '08'), 'https://0ptimus.decisiondeskhq.com/house/MT-HOUSE-At-Large': ('MT', '01'), 'https://0ptimus.decisiondeskhq.com/house/NE-HOUSE-01': ('NE', '01'), 'https://0ptimus.decisiondeskhq.com/house/NE-HOUSE-02': ('NE', '02'), 'https://0ptimus.decisiondeskhq.com/house/NE-HOUSE-03': ('NE', '03'), 'https://0ptimus.decisiondeskhq.com/house/NV-HOUSE-01': ('NV', '01'), 'https://0ptimus.decisiondeskhq.com/house/NV-HOUSE-02': ('NV', '02'), 'https://0ptimus.decisiondeskhq.com/house/NV-HOUSE-03': ('NV', '03'), 'https://0ptimus.decisiondeskhq.com/house/NV-HOUSE-04': ('NV', '04'), 'https://0ptimus.decisiondeskhq.com/house/NH-HOUSE-01': ('NH', '01'), 'https://0ptimus.decisiondeskhq.com/house/NH-HOUSE-02': ('NH', '02'), 'https://0ptimus.decisiondeskhq.com/house/NJ-HOUSE-01': ('NJ', '01'), 'https://0ptimus.decisiondeskhq.com/house/NJ-HOUSE-02': ('NJ', '02'), 'https://0ptimus.decisiondeskhq.com/house/NJ-HOUSE-03': ('NJ', '03'), 'https://0ptimus.decisiondeskhq.com/house/NJ-HOUSE-04': ('NJ', '04'), 'https://0ptimus.decisiondeskhq.com/house/NJ-HOUSE-05': ('NJ', '05'), 'https://0ptimus.decisiondeskhq.com/house/NJ-HOUSE-06': ('NJ', '06'), 'https://0ptimus.decisiondeskhq.com/house/NJ-HOUSE-07': ('NJ', '07'), 'https://0ptimus.decisiondeskhq.com/house/NJ-HOUSE-08': ('NJ', '08'), 'https://0ptimus.decisiondeskhq.com/house/NJ-HOUSE-09': ('NJ', '09'), 'https://0ptimus.decisiondeskhq.com/house/NJ-HOUSE-10': ('NJ', '10'), 'https://0ptimus.decisiondeskhq.com/house/NJ-HOUSE-11': ('NJ', '11'), 'https://0ptimus.decisiondeskhq.com/house/NJ-HOUSE-12': ('NJ', '12'), 'https://0ptimus.decisiondeskhq.com/house/NM-HOUSE-01': ('NM', '01'), 'https://0ptimus.decisiondeskhq.com/house/NM-HOUSE-02': ('NM', '02'), 'https://0ptimus.decisiondeskhq.com/house/NM-HOUSE-03': ('NM', '03'), 'https://0ptimus.decisiondeskhq.com/house/NY-HOUSE-01': ('NY', '01'), 'https://0ptimus.decisiondeskhq.com/house/NY-HOUSE-02': ('NY', '02'), 'https://0ptimus.decisiondeskhq.com/house/NY-HOUSE-03': ('NY', '03'), 'https://0ptimus.decisiondeskhq.com/house/NY-HOUSE-04': ('NY', '04'), 'https://0ptimus.decisiondeskhq.com/house/NY-HOUSE-05': ('NY', '05'), 'https://0ptimus.decisiondeskhq.com/house/NY-HOUSE-06': ('NY', '06'), 'https://0ptimus.decisiondeskhq.com/house/NY-HOUSE-07': ('NY', '07'), 'https://0ptimus.decisiondeskhq.com/house/NY-HOUSE-08': ('NY', '08'), 'https://0ptimus.decisiondeskhq.com/house/NY-HOUSE-09': ('NY', '09'), 'https://0ptimus.decisiondeskhq.com/house/NY-HOUSE-10': ('NY', '10'), 'https://0ptimus.decisiondeskhq.com/house/NY-HOUSE-11': ('NY', '11'), 'https://0ptimus.decisiondeskhq.com/house/NY-HOUSE-12': ('NY', '12'), 'https://0ptimus.decisiondeskhq.com/house/NY-HOUSE-13': ('NY', '13'), 'https://0ptimus.decisiondeskhq.com/house/NY-HOUSE-14': ('NY', '14'), 'https://0ptimus.decisiondeskhq.com/house/NY-HOUSE-15': ('NY', '15'), 'https://0ptimus.decisiondeskhq.com/house/NY-HOUSE-16': ('NY', '16'), 'https://0ptimus.decisiondeskhq.com/house/NY-HOUSE-17': ('NY', '17'), 'https://0ptimus.decisiondeskhq.com/house/NY-HOUSE-18': ('NY', '18'), 'https://0ptimus.decisiondeskhq.com/house/NY-HOUSE-19': ('NY', '19'), 'https://0ptimus.decisiondeskhq.com/house/NY-HOUSE-20': ('NY', '20'), 'https://0ptimus.decisiondeskhq.com/house/NY-HOUSE-21': ('NY', '21'), 'https://0ptimus.decisiondeskhq.com/house/NY-HOUSE-22': ('NY', '22'), 'https://0ptimus.decisiondeskhq.com/house/NY-HOUSE-23': ('NY', '23'), 'https://0ptimus.decisiondeskhq.com/house/NY-HOUSE-24': ('NY', '24'), 'https://0ptimus.decisiondeskhq.com/house/NY-HOUSE-25': ('NY', '25'), 'https://0ptimus.decisiondeskhq.com/house/NY-HOUSE-26': ('NY', '26'), 'https://0ptimus.decisiondeskhq.com/house/NY-HOUSE-27': ('NY', '27'), 'https://0ptimus.decisiondeskhq.com/house/NC-HOUSE-01': ('NC', '01'), 'https://0ptimus.decisiondeskhq.com/house/NC-HOUSE-02': ('NC', '02'), 'https://0ptimus.decisiondeskhq.com/house/NC-HOUSE-03': ('NC', '03'), 'https://0ptimus.decisiondeskhq.com/house/NC-HOUSE-04': ('NC', '04'), 'https://0ptimus.decisiondeskhq.com/house/NC-HOUSE-05': ('NC', '05'), 'https://0ptimus.decisiondeskhq.com/house/NC-HOUSE-06': ('NC', '06'), 'https://0ptimus.decisiondeskhq.com/house/NC-HOUSE-07': ('NC', '07'), 'https://0ptimus.decisiondeskhq.com/house/NC-HOUSE-08': ('NC', '08'), 'https://0ptimus.decisiondeskhq.com/house/NC-HOUSE-09': ('NC', '09'), 'https://0ptimus.decisiondeskhq.com/house/NC-HOUSE-10': ('NC', '10'), 'https://0ptimus.decisiondeskhq.com/house/NC-HOUSE-11': ('NC', '11'), 'https://0ptimus.decisiondeskhq.com/house/NC-HOUSE-12': ('NC', '12'), 'https://0ptimus.decisiondeskhq.com/house/NC-HOUSE-13': ('NC', '13'), 'https://0ptimus.decisiondeskhq.com/house/ND-HOUSE-At-Large': ('ND', '01'), 'https://0ptimus.decisiondeskhq.com/house/OH-HOUSE-01': ('OH', '01'), 'https://0ptimus.decisiondeskhq.com/house/OH-HOUSE-02': ('OH', '02'), 'https://0ptimus.decisiondeskhq.com/house/OH-HOUSE-03': ('OH', '03'), 'https://0ptimus.decisiondeskhq.com/house/OH-HOUSE-04': ('OH', '04'), 'https://0ptimus.decisiondeskhq.com/house/OH-HOUSE-05': ('OH', '05'), 'https://0ptimus.decisiondeskhq.com/house/OH-HOUSE-06': ('OH', '06'), 'https://0ptimus.decisiondeskhq.com/house/OH-HOUSE-07': ('OH', '07'), 'https://0ptimus.decisiondeskhq.com/house/OH-HOUSE-08': ('OH', '08'), 'https://0ptimus.decisiondeskhq.com/house/OH-HOUSE-09': ('OH', '09'), 'https://0ptimus.decisiondeskhq.com/house/OH-HOUSE-10': ('OH', '10'), 'https://0ptimus.decisiondeskhq.com/house/OH-HOUSE-11': ('OH', '11'), 'https://0ptimus.decisiondeskhq.com/house/OH-HOUSE-12': ('OH', '12'), 'https://0ptimus.decisiondeskhq.com/house/OH-HOUSE-13': ('OH', '13'), 'https://0ptimus.decisiondeskhq.com/house/OH-HOUSE-14': ('OH', '14'), 'https://0ptimus.decisiondeskhq.com/house/OH-HOUSE-15': ('OH', '15'), 'https://0ptimus.decisiondeskhq.com/house/OH-HOUSE-16': ('OH', '16'), 'https://0ptimus.decisiondeskhq.com/house/OK-HOUSE-01': ('OK', '01'), 'https://0ptimus.decisiondeskhq.com/house/OK-HOUSE-02': ('OK', '02'), 'https://0ptimus.decisiondeskhq.com/house/OK-HOUSE-03': ('OK', '03'), 'https://0ptimus.decisiondeskhq.com/house/OK-HOUSE-04': ('OK', '04'), 'https://0ptimus.decisiondeskhq.com/house/OK-HOUSE-05': ('OK', '05'), 'https://0ptimus.decisiondeskhq.com/house/OR-HOUSE-01': ('OR', '01'), 'https://0ptimus.decisiondeskhq.com/house/OR-HOUSE-02': ('OR', '02'), 'https://0ptimus.decisiondeskhq.com/house/OR-HOUSE-03': ('OR', '03'), 'https://0ptimus.decisiondeskhq.com/house/OR-HOUSE-04': ('OR', '04'), 'https://0ptimus.decisiondeskhq.com/house/OR-HOUSE-05': ('OR', '05'), 'https://0ptimus.decisiondeskhq.com/house/PA-HOUSE-01': ('PA', '01'), 'https://0ptimus.decisiondeskhq.com/house/PA-HOUSE-02': ('PA', '02'), 'https://0ptimus.decisiondeskhq.com/house/PA-HOUSE-03': ('PA', '03'), 'https://0ptimus.decisiondeskhq.com/house/PA-HOUSE-04': ('PA', '04'), 'https://0ptimus.decisiondeskhq.com/house/PA-HOUSE-05': ('PA', '05'), 'https://0ptimus.decisiondeskhq.com/house/PA-HOUSE-06': ('PA', '06'), 'https://0ptimus.decisiondeskhq.com/house/PA-HOUSE-07': ('PA', '07'), 'https://0ptimus.decisiondeskhq.com/house/PA-HOUSE-08': ('PA', '08'), 'https://0ptimus.decisiondeskhq.com/house/PA-HOUSE-09': ('PA', '09'), 'https://0ptimus.decisiondeskhq.com/house/PA-HOUSE-10': ('PA', '10'), 'https://0ptimus.decisiondeskhq.com/house/PA-HOUSE-11': ('PA', '11'), 'https://0ptimus.decisiondeskhq.com/house/PA-HOUSE-12': ('PA', '12'), 'https://0ptimus.decisiondeskhq.com/house/PA-HOUSE-13': ('PA', '13'), 'https://0ptimus.decisiondeskhq.com/house/PA-HOUSE-14': ('PA', '14'), 'https://0ptimus.decisiondeskhq.com/house/PA-HOUSE-15': ('PA', '15'), 'https://0ptimus.decisiondeskhq.com/house/PA-HOUSE-16': ('PA', '16'), 'https://0ptimus.decisiondeskhq.com/house/PA-HOUSE-17': ('PA', '17'), 'https://0ptimus.decisiondeskhq.com/house/PA-HOUSE-18': ('PA', '18'), 'https://0ptimus.decisiondeskhq.com/house/RI-HOUSE-01': ('RI', '01'), 'https://0ptimus.decisiondeskhq.com/house/RI-HOUSE-02': ('RI', '02'), 'https://0ptimus.decisiondeskhq.com/house/SC-HOUSE-01': ('SC', '01'), 'https://0ptimus.decisiondeskhq.com/house/SC-HOUSE-02': ('SC', '02'), 'https://0ptimus.decisiondeskhq.com/house/SC-HOUSE-03': ('SC', '03'), 'https://0ptimus.decisiondeskhq.com/house/SC-HOUSE-04': ('SC', '04'), 'https://0ptimus.decisiondeskhq.com/house/SC-HOUSE-05': ('SC', '05'), 'https://0ptimus.decisiondeskhq.com/house/SC-HOUSE-06': ('SC', '06'), 'https://0ptimus.decisiondeskhq.com/house/SC-HOUSE-07': ('SC', '07'), 'https://0ptimus.decisiondeskhq.com/house/SD-HOUSE-At-Large': ('SD', '01'), 'https://0ptimus.decisiondeskhq.com/house/TN-HOUSE-01': ('TN', '01'), 'https://0ptimus.decisiondeskhq.com/house/TN-HOUSE-02': ('TN', '02'), 'https://0ptimus.decisiondeskhq.com/house/TN-HOUSE-03': ('TN', '03'), 'https://0ptimus.decisiondeskhq.com/house/TN-HOUSE-04': ('TN', '04'), 'https://0ptimus.decisiondeskhq.com/house/TN-HOUSE-05': ('TN', '05'), 'https://0ptimus.decisiondeskhq.com/house/TN-HOUSE-06': ('TN', '06'), 'https://0ptimus.decisiondeskhq.com/house/TN-HOUSE-07': ('TN', '07'), 'https://0ptimus.decisiondeskhq.com/house/TN-HOUSE-08': ('TN', '08'), 'https://0ptimus.decisiondeskhq.com/house/TN-HOUSE-09': ('TN', '09'), 'https://0ptimus.decisiondeskhq.com/house/TX-HOUSE-01': ('TX', '01'), 'https://0ptimus.decisiondeskhq.com/house/TX-HOUSE-02': ('TX', '02'), 'https://0ptimus.decisiondeskhq.com/house/TX-HOUSE-03': ('TX', '03'), 'https://0ptimus.decisiondeskhq.com/house/TX-HOUSE-04': ('TX', '04'), 'https://0ptimus.decisiondeskhq.com/house/TX-HOUSE-05': ('TX', '05'), 'https://0ptimus.decisiondeskhq.com/house/TX-HOUSE-06': ('TX', '06'), 'https://0ptimus.decisiondeskhq.com/house/TX-HOUSE-07': ('TX', '07'), 'https://0ptimus.decisiondeskhq.com/house/TX-HOUSE-08': ('TX', '08'), 'https://0ptimus.decisiondeskhq.com/house/TX-HOUSE-09': ('TX', '09'), 'https://0ptimus.decisiondeskhq.com/house/TX-HOUSE-10': ('TX', '10'), 'https://0ptimus.decisiondeskhq.com/house/TX-HOUSE-11': ('TX', '11'), 'https://0ptimus.decisiondeskhq.com/house/TX-HOUSE-12': ('TX', '12'), 'https://0ptimus.decisiondeskhq.com/house/TX-HOUSE-13': ('TX', '13'), 'https://0ptimus.decisiondeskhq.com/house/TX-HOUSE-14': ('TX', '14'), 'https://0ptimus.decisiondeskhq.com/house/TX-HOUSE-15': ('TX', '15'), 'https://0ptimus.decisiondeskhq.com/house/TX-HOUSE-16': ('TX', '16'), 'https://0ptimus.decisiondeskhq.com/house/TX-HOUSE-17': ('TX', '17'), 'https://0ptimus.decisiondeskhq.com/house/TX-HOUSE-18': ('TX', '18'), 'https://0ptimus.decisiondeskhq.com/house/TX-HOUSE-19': ('TX', '19'), 'https://0ptimus.decisiondeskhq.com/house/TX-HOUSE-20': ('TX', '20'), 'https://0ptimus.decisiondeskhq.com/house/TX-HOUSE-21': ('TX', '21'), 'https://0ptimus.decisiondeskhq.com/house/TX-HOUSE-22': ('TX', '22'), 'https://0ptimus.decisiondeskhq.com/house/TX-HOUSE-23': ('TX', '23'), 'https://0ptimus.decisiondeskhq.com/house/TX-HOUSE-24': ('TX', '24'), 'https://0ptimus.decisiondeskhq.com/house/TX-HOUSE-25': ('TX', '25'), 'https://0ptimus.decisiondeskhq.com/house/TX-HOUSE-26': ('TX', '26'), 'https://0ptimus.decisiondeskhq.com/house/TX-HOUSE-27': ('TX', '27'), 'https://0ptimus.decisiondeskhq.com/house/TX-HOUSE-28': ('TX', '28'), 'https://0ptimus.decisiondeskhq.com/house/TX-HOUSE-29': ('TX', '29'), 'https://0ptimus.decisiondeskhq.com/house/TX-HOUSE-30': ('TX', '30'), 'https://0ptimus.decisiondeskhq.com/house/TX-HOUSE-31': ('TX', '31'), 'https://0ptimus.decisiondeskhq.com/house/TX-HOUSE-32': ('TX', '32'), 'https://0ptimus.decisiondeskhq.com/house/TX-HOUSE-33': ('TX', '33'), 'https://0ptimus.decisiondeskhq.com/house/TX-HOUSE-34': ('TX', '34'), 'https://0ptimus.decisiondeskhq.com/house/TX-HOUSE-35': ('TX', '35'), 'https://0ptimus.decisiondeskhq.com/house/TX-HOUSE-36': ('TX', '36'), 'https://0ptimus.decisiondeskhq.com/house/UT-HOUSE-01': ('UT', '01'), 'https://0ptimus.decisiondeskhq.com/house/UT-HOUSE-02': ('UT', '02'), 'https://0ptimus.decisiondeskhq.com/house/UT-HOUSE-03': ('UT', '03'), 'https://0ptimus.decisiondeskhq.com/house/UT-HOUSE-04': ('UT', '04'), 'https://0ptimus.decisiondeskhq.com/house/VT-HOUSE-At-Large': ('VT', '01'), 'https://0ptimus.decisiondeskhq.com/house/VA-HOUSE-01': ('VA', '01'), 'https://0ptimus.decisiondeskhq.com/house/VA-HOUSE-02': ('VA', '02'), 'https://0ptimus.decisiondeskhq.com/house/VA-HOUSE-03': ('VA', '03'), 'https://0ptimus.decisiondeskhq.com/house/VA-HOUSE-04': ('VA', '04'), 'https://0ptimus.decisiondeskhq.com/house/VA-HOUSE-05': ('VA', '05'), 'https://0ptimus.decisiondeskhq.com/house/VA-HOUSE-06': ('VA', '06'), 'https://0ptimus.decisiondeskhq.com/house/VA-HOUSE-07': ('VA', '07'), 'https://0ptimus.decisiondeskhq.com/house/VA-HOUSE-08': ('VA', '08'), 'https://0ptimus.decisiondeskhq.com/house/VA-HOUSE-09': ('VA', '09'), 'https://0ptimus.decisiondeskhq.com/house/VA-HOUSE-10': ('VA', '10'), 'https://0ptimus.decisiondeskhq.com/house/VA-HOUSE-11': ('VA', '11'), 'https://0ptimus.decisiondeskhq.com/house/WA-HOUSE-01': ('WA', '01'), 'https://0ptimus.decisiondeskhq.com/house/WA-HOUSE-02': ('WA', '02'), 'https://0ptimus.decisiondeskhq.com/house/WA-HOUSE-03': ('WA', '03'), 'https://0ptimus.decisiondeskhq.com/house/WA-HOUSE-04': ('WA', '04'), 'https://0ptimus.decisiondeskhq.com/house/WA-HOUSE-05': ('WA', '05'), 'https://0ptimus.decisiondeskhq.com/house/WA-HOUSE-06': ('WA', '06'), 'https://0ptimus.decisiondeskhq.com/house/WA-HOUSE-07': ('WA', '07'), 'https://0ptimus.decisiondeskhq.com/house/WA-HOUSE-08': ('WA', '08'), 'https://0ptimus.decisiondeskhq.com/house/WA-HOUSE-09': ('WA', '09'), 'https://0ptimus.decisiondeskhq.com/house/WA-HOUSE-10': ('WA', '10'), 'https://0ptimus.decisiondeskhq.com/house/WV-HOUSE-01': ('WV', '01'), 'https://0ptimus.decisiondeskhq.com/house/WV-HOUSE-02': ('WV', '02'), 'https://0ptimus.decisiondeskhq.com/house/WV-HOUSE-03': ('WV', '03'), 'https://0ptimus.decisiondeskhq.com/house/WI-HOUSE-01': ('WI', '01'), 'https://0ptimus.decisiondeskhq.com/house/WI-HOUSE-02': ('WI', '02'), 'https://0ptimus.decisiondeskhq.com/house/WI-HOUSE-03': ('WI', '03'), 'https://0ptimus.decisiondeskhq.com/house/WI-HOUSE-04': ('WI', '04'), 'https://0ptimus.decisiondeskhq.com/house/WI-HOUSE-05': ('WI', '05'), 'https://0ptimus.decisiondeskhq.com/house/WI-HOUSE-06': ('WI', '06'), 'https://0ptimus.decisiondeskhq.com/house/WI-HOUSE-07': ('WI', '07'), 'https://0ptimus.decisiondeskhq.com/house/WI-HOUSE-08': ('WI', '08')}

    workbook = xlsxwriter.Workbook('optimus_headless.xlsx')
    worksheet = workbook.add_worksheet()
    row = 0
    col = 0
    header = (['State', 'District', 'Resp probability'])
    for item in header:
        worksheet.write(row, col, item)
        col += 1
    col = 0
    row += 1

    for link in links:
        not_finished = True
        while not_finished:
            try:
                driver.get(link)
                # sleep(2)
                login = True
                try:
                    WebDriverWait(driver, 10).until(
                        EC.presence_of_all_elements_located(
                            (By.XPATH, '//*[@id="content-container"]/div/div/div[2]/div[4]/div/div[2]/div[1]/div[2]')))
                    login = False
                except TimeoutException:
                    pass

                if login:
                    try:
                        WebDriverWait(driver, 10).until(EC.presence_of_all_elements_located(
                                (By.CSS_SELECTOR, "input[type='email']")))
                    except TimeoutException:
                        continue

                    email1 = driver.find_element_by_css_selector("input[type='email']")
                    password1 = driver.find_element_by_css_selector("input[type='password']")

                    email1.send_keys(user)
                    password1.send_keys(pwd)

                    driver.find_element_by_css_selector('button.btn.primary').click()

                try:
                    WebDriverWait(driver, delay).until(EC.presence_of_all_elements_located(
                            (By.CSS_SELECTOR, 'div.detail-scoreboard.detail-scoreboard-teams')))
                except TimeoutException:
                    continue

                part = driver.find_element_by_css_selector('div.detail-scoreboard.detail-scoreboard-teams')

                cl = part.find_element_by_css_selector('div.detail-team-republicans')
                cl = cl.find_element_by_css_selector('div.detail-team-name')
                cl = cl.get_attribute('innerHTML')

                prob = part.find_element_by_css_selector('div.detail-team-republicans')
                prob = prob.find_element_by_css_selector('div.detail-team-score')
                prob = prob.get_attribute('innerHTML')
                prob = prob[:-1]

                if cl != 'Republicans':
                    prob = 100.0 - float(prob)

                data_to_save = (links[link][0], links[link][1], str(prob))

                print(data_to_save)

                for item in data_to_save:
                    worksheet.write(row, col, item)
                    col += 1

                col = 0
                row += 1
                not_finished = False
            except Exception as e:
                print('Error: ', link)
                pass

    workbook.close()
    driver.quit()


if __name__ == '__main__':
    retrieve()

